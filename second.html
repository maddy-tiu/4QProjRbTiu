<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Maddy Tiu">
        <meta name="description" content="Online cinema booking">
        <meta name="keywords" content="reservation, movies, cinema">
        <meta name="revised" content="14-05-2022">
        
        <title>MovieClicker</title>

        <link rel="stylesheet" href="./css/styles.css">
    </head>
    <body id="rsrvPage">
        <h1>Book your seats now!</h1>
        <h3>Currently showing:</h3>
        <div id="currentlyShowing">
            <div class="poster">
                <img class="pic" src="./images/dr_strange.png">
            </div>
            <div class="poster">
                <img class="pic" src="./images/fntstc_beasts.png">
            </div>
            <div class="poster">
                <img class="pic" src="./images/sonic2.png">
            </div>
        </div>

        <form id="formData" action="third.html" method="get" autocomplete="on">
            <legend id="rsrvHeading">Reservation Details:</legend>
            <p>
                <label for="name">Name of reservee</label> <br />
                <input type="text" name="firstName" id="firstName" placeholder="First Name" required />
                <input type="text" name="lastName" id="lastName" placeholder="Last Name" required />
            </p> <br />

            <p>
                <label for="email">Email</label> <br />
                <input type="email" name="email" id="email" placeholder="email@address.com" required />
            </p> <br />

            <p>
                <label for="phone">Cellphone number</label> <br />
                <input type="tel" name="cell" id="cell" placeholder="1234-567-8999" required />
            </p> <br />

            <p>
                <label for="tickets">Number of tickets</label>
                <input type="number" name="numTickets" id="numTickets" min="1" max="9" required />
            </p> <br />
            
            <p>
                <label for="date">Date and time of viewing</label> <br />
                <input type="datetime-local" name="date" id="date" required />
            </p>

            <fieldset id="movieChoice">
                <legend>What movie are you watching?</legend>
                <p><input type="radio" name="movie" required value="Doctor Strange"><label> Doctor Strange in the Multiverse of Madness</label></p>
                <p><input type="radio" name="movie" required value="Fantastic Beasts"><label> Fantastic Beasts: The Secrets of Dumbledore</label></p>
                <p><input type="radio" name="movie" required value="Sonic 2"><label> Sonic the Hedgehog 2</label></p>
            </fieldset>

            <fieldset id="food">
                <legend>Snacks?</legend>
                <p><input type="checkbox" name="food" value="Popcorn"><label> Popcorn</label></p>
                <p><input type="checkbox" name="food" value="Candy"><label> Candy</label></p>
                <p><input type="checkbox" name="food" value="Soft Drink"><label> Soft Drink</label></p>
                <p><input type="checkbox" name="food" value="Hotdog"><label> Hot Dog</label></p>
            </fieldset> 

            <p>
                <label for="seating">Seating Arrangement </label> 
                <select id="seating" name="seating">
                    <option value="" selected="selected">Select a section</option>
                    <option value="sectionA">Section A</option>
                    <option value="sectionB">Section B</option>
                    <option value="sectionC">Section C</option>
                    <option value="sectionD">Section D</option>
                    <option value="sectionE">Section E</option>
                    <option value="sectionF">Section F</option>
                </select>
            </p> <br />

            <p>
                <input type="submit" value="Book tickets" id="formBtn">
                <input type="reset" value="Clear information" id="formBtn">
            </p> <br /><br />

            <p>
                <a href="./index.html" id="prevWelcome">Back to Welcome Page</a> 
            </p> <br /><br />
        </form>

        <script>
            function formAction(event) {
                if(confirm("Book reservation?")) {
                    let data = new FormData(event.target);
                    let formData = Object.fromEntries(data.entries());
                        formData.food = data.getAll("food")
                    let formDataString = JSON.stringify(formData);
                    let keyDataName = "formData" + reservation;
                    localStorage.setItem(keyDataName, formDataString);
                    localStorage.setItem("reservation", reservation);
                }
                else {
                    event.preventDefault();
                }
            } 
            let reservationForm = document.forms[0];
            reservationForm.addEventListener("submit", formAction);
            reservationForm.addEventListener("reset", function(event) {
                if(confirm("Clear all information?")) {
                    reservationForm.reset();
                }
                else {
                    event.preventDefault();
                }
            })
            let reservation = localStorage.getItem("reservation");           
        </script>
    </body>
</html>